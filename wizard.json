{
    "version": 1,
    "supportedProjectTypes": [ "CMakeProjectManager.CMakeProject", "Qbs.QbsProject" ],
    "id": "ARM_project",
    "category": "I.Projects",
    "trDescription": "Creates a simple C application for arm.",
    "trDisplayName": "Application for arm",
    "trDisplayCategory": "Non-Qt Project",
    "icon": "../../global/consoleapplication.png",
    "enabled": "%{JS: value('Plugins').indexOf('CppEditor') >= 0 && (value('Plugins').indexOf('QbsProjectManager') >= 0 || value('Plugins').indexOf('CMakeProjectManager') >= 0)}",

    "options":
    [
        { "key": "ProjectFile", "value": "%{JS: value('BuildSystem') === 'cmake' ? value('CMakeFile') : value('QbsFile')}" },
        { "key": "QbsFile", "value": "%{JS: Util.fileName('%{ProjectDirectory}/%{ProjectName}', 'qbs')}" },
        { "key": "CMakeFile", "value": "%{ProjectDirectory}/CMakeLists.txt" },
        { "key": "CFileName", "value": "%{JS: 'main.' + Util.preferredSuffix('text/x-csrc')}" },
        { "key": "IsTopLevelProject", "value": "%{JS: !'%{Exists:ProjectExplorer.Profile.Ids}'}" },
        { "key": "TypeDef", "value": "%{JS: '%{SerialController}' === 'stm32f1xx' ? '%{TypeF1}' : \
                                            '%{SerialController}' === 'stm32f3xx' ? '%{TypeF3}' : \
                                            '%{SerialController}' === 'stm32f4xx' ? '%{TypeF4}' : \
                                            '%{SerialController}' === 'stm32g0xx' ? '%{TypeG0}' : \
                                            '%{SerialController}' === 'stm32g4xx' ? '%{TypeG4}' : ' ' }" }
    ],

    "pages":
    [
        {
            "trDisplayName": "Project Location",
            "trShortTitle": "Location",
            "typeId": "Project"
        },
        {
            "trDisplayName": "Define Build System",
            "trShortTitle": "Build System",
            "typeId": "Fields",
            "enabled": "%{IsTopLevelProject}",
            "data":
            [
                {
                    "name": "BuildSystem",
                    "trDisplayName": "Build system:",
                    "type": "ComboBox",
                    "persistenceKey": "BuildSystemType",
                    "data":
                    {
                        "index": 0,
                        "items":
                        [
                            {
                                "trKey": "CMake",
                                "value": "cmake",
                                "condition": "%{JS: value('Plugins').indexOf('CMakeProjectManager') >= 0}"
                            },
                            {
                                "trKey": "Qbs",
                                "value": "qbs",
                                "condition": "%{JS: value('Plugins').indexOf('QbsProjectManager') >= 0}"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "trDisplayName": "Kit Selection",
            "trShortTitle": "Kits",
            "typeId": "Kits",
            "enabled": "%{IsTopLevelProject}",
            "data": { "projectFilePath": "%{ProjectFile}" }
        },
        {
            "trDisplayName": "Choose a Type Template",
            "trShortTitle": "Details",
            "typeId": "Fields",
            "data" :
            [
                {
                    "name": "SerialController",
                    "trDisplayName": "Serial of controllers",
                    "type": "ComboBox",
                    "data":
                    {
                        "index": 0,
                        "items":
                        [
                            {"trKey": "STM32F1","value":"stm32f1xx"},
                            {"trKey": "STM32F3","value":"stm32f3xx"},
                            {"trKey": "STM32F4","value":"stm32f4xx"},
                            {"trKey": "STM32G0","value":"stm32g0xx"},
                            {"trKey": "STM32G4","value":"stm32g4xx"}
                        ]
                    }
                },
                {
                    "name": "TypeF1",
                    "trDisplayName": "Type MK:",
                    "type": "ComboBox",
                    "visible": "%{JS: '%{SerialController}' === 'stm32f1xx'}",
                    "data":
                    {
                        "index": 0,
                        "items":
                        [
                            "STM32F100xB",
                            "STM32F100xE",
                            "STM32F101x6",
                            "STM32F101xB",
                            "STM32F101xE",
                            "STM32F101xG",
                            "STM32F102x6",
                            "STM32F102xB",
                            "STM32F103x6",
                            "STM32F103xB",
                            "STM32F103xE",
                            "STM32F103xG",
                            "STM32F105xC",
                            "STM32F107xC"
                        ]
                    }
                },
                {
                    "name": "TypeF3",
                    "trDisplayName": "Type MK:",
                    "type": "ComboBox",
                    "visible": "%{JS: '%{SerialController}' === 'stm32f3xx'}",
                    "data":
                    {
                        "index": 0,
                        "items":
                        [
                            "STM32F301x8",
                            "STM32F302x8",
                            "STM32F302xC",
                            "STM32F302xE",
                            "STM32F303x8",
                            "STM32F303xC",
                            "STM32F303xE",
                            "STM32F318xx",
                            "STM32F328xx",
                            "STM32F334x8",
                            "STM32F358xx",
                            "STM32F373xC",
                            "STM32F378xx",
                            "STM32F398xx"
                        ]
                    }
                },
                {
                    "name": "TypeF4",
                    "trDisplayName": "Type MK:",
                    "type": "ComboBox",
                    "visible": "%{JS: '%{SerialController}' === 'stm32f4xx'}",
                    "data":
                    {
                        "index": 0,
                        "items":
                        [
                            "STM32F401xC",
                            "STM32F401xE",
                            "STM32F405xx",
                            "STM32F407xx",
                            "STM32F410Tx",
                            "STM32F410Cx",
                            "STM32F410Rx",
                            "STM32F411xE",
                            "STM32F412Cx",
                            "STM32F412Zx",
                            "STM32F412Vx",
                            "STM32F412Rx",
                            "STM32F413xx",
                            "STM32F415xx",
                            "STM32F417xx",
                            "STM32F423xx",
                            "STM32F427xx",
                            "STM32F429xx",
                            "STM32F437xx",
                            "STM32F439xx",
                            "STM32F446xx",
                            "STM32F469xx",
                            "STM32F479xx"
                        ]
                    }
                },
                {
                    "name": "TypeG0",
                    "trDisplayName": "Type MK:",
                    "type": "ComboBox",
                    "visible": "%{JS: '%{SerialController}' === 'stm32g0xx'}",
                    "data":
                    {
                        "index": 0,
                        "items":
                        [
                            "STM32G0B0xx",
                            "STM32G0B1xx",
                            "STM32G0C1xx",
                            "STM32G030xx",
                            "STM32G031xx",
                            "STM32G041xx",
                            "STM32G050xx",
                            "STM32G051xx",
                            "STM32G061xx",
                            "STM32G070xx",
                            "STM32G071xx",
                            "STM32G081xx"
                        ]
                    }
                },
                {
                    "name": "TypeG4",
                    "trDisplayName": "Type MK:",
                    "type": "ComboBox",
                    "visible": "%{JS: '%{SerialController}' === 'stm32g4xx'}",
                    "data":
                    {
                        "index": 0,
                        "items":
                        [
                            "STM32G431xx",
                            "STM32G441xx",
                            "STM32G471xx",
                            "STM32G473xx",
                            "STM32G474xx",
                            "STM32G484xx",
                            "STM32G491xx",
                            "STM32G4A1xx",
                            "STM32GBK1CB"
                        ]
                    }
                },
                {
                    "name": "SizeRAM",
                    "trDisplayName": "size RAM memory [kB]",
                    "type": "LineEdit",
                    "data":
                    {
                        "trPlaceholder": "Enter memory size in kB",
                        "validator": "(?:[1-9]{1}[0-9]{0,10})"
                    }
                },
                {
                    "name": "SizeFlash",
                    "trDisplayName": "size FLASH memory [kB]",
                    "type": "LineEdit",
                    "data":
                    {
                        "trPlaceholder": "Enter memory size in kB",
                        "validator": "(?:[1-9]{1}[0-9]{0,10})"
                    }
                },
                {
                    "name": "UseMath",
                    "trDisplayName": "include math library",
                    "type": "CheckBox",
                    "data":
                    {
                        "checkedValue": "QObject",
                        "uncheckedValue": "false"
                    }
                }
            ]
        },
        {
            "trDisplayName": "Project Management",
            "trShortTitle": "Summary",
            "typeId": "Summary"
        }
    ],
    "generators":
    [
    {
    "typeId": "File",
    "data":
    [
        {
            "source": "CMakeLists.txt",
            "openAsProject": true,
            "condition": "%{JS: value('BuildSystem') === 'cmake'}"
        },
        {
            "source": "cmake",
            "target": "cmake",
            "condition": "%{JS: value('BuildSystem') === 'cmake'}"
        },
        {
            "source": "stm32xxxx.qbs",
            "target": "%{QbsFile}",
            "openAsProject": true,
            "condition": "%{JS: value('BuildSystem') === 'qbs'}"
        },
        {
            "source": "main.c",
            "target": "%{CFileName}",
            "openInEditor": true
        },
        {
            "source": "stm32.h",
            "target": "stm32.h"
        },
        {
            "source": "linkers/_FLASH.ld",
            "target": "%{TypeDef}_FLASH.ld",
            "openInEditor": true
        },
        {
            "source": "Driver",
            "target": "Driver"
        },
        {
            "source": "CMSIS_%{SerialController}",
            "target": "CMSIS"
        },
        {
            "source": "DSP_Lib",
            "target": "DSP_Lib",
            "condition": "%{JS: %{UseMath} === 'true'}"
        },
        {
            "source": "../git.ignore",
            "target": "%{ProjectDirectory}/.gitignore",
            "condition": "%{JS: ! %{IsSubproject} && '%{VersionControl}' === 'G.Git'}"
        }
        ]
        }
    ]
}
